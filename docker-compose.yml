services:
  # Generic service - entrypoint can be overridden dynamically
  ai-cli:
    build:
      context: .
      dockerfile: Docker/Dockerfile.ai-cli
      args:
        - ARG_UV_VERSION=${UV_VERSION}
        - ARG_PLAYWRIGHT_MCP_VERSION=${PLAYWRIGHT_MCP_VERSION}
    working_dir: /workspace
    volumes:
      # Mount the *caller's* CWD (set by wrapper) into /workspace
      - type: bind
        source: ${HOST_PWD}
        target: /workspace
      # Persist full home (auth + settings)
      - ai-cli_home:/root
      - playwright_cache:/root/.cache/ms-playwright   # <-- persist browsers
    stdin_open: true
    tty: true

volumes:
  ai-cli_home: {}
  playwright_cache: {}
